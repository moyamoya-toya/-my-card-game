<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>カードゲームプレビュー</title>
    <style>
        body {
            margin: 0;
            padding: 20px; /* コンテンツ全体に余白 */
            background-color: #e0f2f7; /* 明るい水色系の背景 */
            font-family: sans-serif;
            color: #333; /* 基本的なテキストカラー */
            padding-bottom: 80px; /* リスタートボタンの領域を確保 */
        }

        /* カードコンテナにホバーエフェクトを追加 */
        .card-container:hover .card {
            transform: translateY(-5px);
            transition: transform 0.2s ease-in-out;
        }
        .card {
            transition: transform 0.2s ease-in-out; /* ホバー解除時のアニメーション */
            background-color: #ffffff; /* カードの背景は白 */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2); /* より立体的な影 */
            position: relative; /* 画像やタイトル、ボタンの配置のために必要 */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; /* 上から要素を配置 */
            width: 150px; /* カードの幅を固定 */
            height: 220px; /* カードの高さを固定 */
        }

        /* カードコンテンツ（画像または裏面情報）エリア */
        .card-content-area {
            width: 100%;
            height: calc(100% - 30px); /* タイトルバー分の高さを引く */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 10px;
            box-sizing: border-box; /* paddingをwidth/heightに含める */
            position: relative; /* 日付情報を重ねるために必要 */
        }

        /* カード画像スタイル */
        .card-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* アスペクト比を維持して表示 */
        }

        /* 裏面カードの日付情報オーバーレイ */
        /* このスタイルは使われなくなりますが、念のため残しておきます */
        /* .card-back .date-overlay { ... } */


        /* カードタイトルバーのスタイル */
        .card-title-bar {
             position: absolute;
             bottom: 0;
             left: 0;
             width: 100%;
             background-color: rgba(0, 0, 0, 0.7);
             color: white;
             font-size: small;
             text-align: center;
             padding: 5px 0;
             box-sizing: border-box;
        }

        /* 裏面カードの年月日表示バーのスタイル */
        .date-bar {
            position: absolute;
            bottom: 50px; /* タイトルバーの上に配置 - 高さを調整 */
            left: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* タイトルバーより少し薄い半透明の黒 */
            color: white;
            font-size: medium; /* タイトルより少し大きく */
            font-weight: bold;
            text-align: center;
            padding: 5px 0;
            box-sizing: border-box;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7); /* 影を追加して見やすく */
            z-index: 5; /* タイトルバーより上、ボタンより下 */
        }


        /* カード上のボタン（選択、左右、確認）のスタイル */
        .card-button {
             position: absolute;
             padding: 5px;
             font-size: small;
             z-index: 10; /* 他の要素より前面に表示 */
             white-space: nowrap; /* ボタン内のテキストを折り返さない */
             border: none;
             border-radius: 3px;
             cursor: pointer;
             box-shadow: 0 1px 2px rgba(0,0,0,0.2);
             transition: background-color 0.3s ease;
        }

        .select-button {
            top: 5px;
            left: 5px;
            background-color: #2196f3; /* 青系 */
            color: white;
        }
        .select-button:hover {
            background-color: #1976d2; /* 濃い青系 */
        }
        .select-button:active {
            background-color: #0d47a1; /* さらに濃い青系 */
        }

        .left-button {
            top: 5px;
            left: 5px;
            background-color: #ff9800; /* オレンジ系 */
            color: white;
        }
        .left-button:hover {
            background-color: #f57c00; /* 濃いオレンジ系 */
        }
         .left-button:active {
             background-color: #ef6c00; /* さらに濃いオレンジ系 */
         }

        .right-button {
            top: 5px;
            right: 5px;
            background-color: #ff9800; /* オレンジ系 */
            color: white;
        }
         .right-button:hover {
             background-color: #f57c00; /* 濃いオレンジ系 */
         }
          .right-button:active {
              background-color: #ef6c00; /* さらに濃いオレンジ系 */
          }

        .discard-confirm-button {
             top: 5px; /* 上からの位置を調整 */
             left: 5px; /* 左からの位置を調整 */
             background-color: #ffb74d; /* ボタンの色 - オレンジ系 */
             color: white;
        }
         .discard-confirm-button:hover {
              background-color: #ffa726; /* ホバー時の色 */
          }
         .discard-confirm-button:active {
             background-color: #f57c00; /* さらに濃いオレンジ系 */
         }


        /* スクロールバーのスタイルを調整 (任意) */
        #hand-field::-webkit-scrollbar,
        #common-field::-webkit-scrollbar,
        #discard-field::-webkit-scrollbar { /* 捨て札フィールドを追加 */
            height: 8px;
        }

        #hand-field::-webkit-scrollbar-track,
        #common-field::-webkit-scrollbar-track,
        #discard-field::-webkit-scrollbar-track { /* 捨て札フィールドを追加 */
            background: #f1f1f1;
            border-radius: 10px;
        }

        #hand-field::-webkit-scrollbar-thumb,
        #common-field::-webkit-scrollbar-thumb,
        #discard-field::-webkit-scrollbar-thumb { /* 捨て札フィールドを追加 */
            background: #888;
            border-radius: 10px;
        }

        #hand-field::-webkit-scrollbar-thumb:hover,
        #common-field::-webkit-scrollbar-thumb:hover,
        #discard-field::-webkit-scrollbar-thumb:hover { /* 捨て札フィールドを追加 */
            background: #555;
        }

         /* 捨て札フィールドのスタイル */
        #discard-field {
            background-color: #b2dfdb; /* 場札と同じ薄いティール系のマットな色 */
            width: 100%; /* 親要素の幅いっぱいに */
            height: 250px;
            display: flex;
            flex-direction: row;
            align-items: center;
            padding: 10px;
            overflow-x: auto; /* 横方向のスクロールを有効に */
            margin-bottom: 20px;
            border-radius: 10px;
            border: none; /* ボーダーを削除 */
        }

        /* 手札フィールドのスタイル */
        #hand-field {
            background-color: #bbdefb; /* 薄い青系のマットな色 */
            width: 100%;
            height: 250px;
            display: flex;
            flex-direction: row;
            align-items: center;
            padding: 10px;
            overflow-x: auto;
            margin-bottom: 20px;
            border-radius: 10px;
        }

        /* 場札フィールドのスタイル */
        #common-field {
            background-color: #b2dfdb; /* 薄いティール系のマットな色 */
            width: 100%;
            height: 250px;
            display: flex;
            flex-direction: row;
            align-items: center;
            padding: 10px;
            overflow-x: auto;
            margin-bottom: 20px;
            border-radius: 10px;
        }


        /* ボタンコンテナのスタイル */
        #button-container {
            margin-bottom: 10px; /* 手札枚数設定エリアとの間に余白 */
            display: flex; /* Flexboxを使用 */
            align-items: center; /* 垂直方向中央揃え */
            justify-content: center; /* 水平方向中央揃え */
            width: 100%; /* 親要素の幅いっぱいに */
        }

         #decision-button { /* 決定ボタンのスタイル */
            padding: 10px 20px;
            font-size: large;
            margin: 0 10px; /* ボタン間の余白 */
            border: none;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: background-color 0.3s ease;
            background-color: #26a69a; /* 決定ボタンの色 - ティール系 */
            color: black; /* 文字色を黒に変更 */
         }

         #decision-button:disabled {
             background-color: #b2dfdb; /* 無効時の色 */
             cursor: not-allowed;
         }

         #decision-button:hover:not(:disabled) {
             background-color: #00897b; /* ホバー時の色 */
         }

         /* リスタートボタンコンテナのスタイル */
         #restart-button-container {
             position: fixed; /* 画面下部に固定 */
             bottom: 20px; /* 下からの距離 */
             left: 0;
             width: 100%;
             display: flex;
             justify-content: center; /* 水平方向中央揃え */
             z-index: 100; /* 他の要素より前面に */
         }

         #restart-button { /* リスタートボタンのスタイル */
             padding: 10px 20px;
             font-size: large;
             border: none;
             border-radius: 5px;
             cursor: pointer;
             box-shadow: 0 2px 4px rgba(0,0,0,0.2);
             transition: background-color 0.3s ease;
             background-color: #ff9800; /* リスタートボタンの色 - オレンジ系 */
             color: white;
         }

         #restart-button:hover {
             background-color: #f57c00; /* ホバー時の色 */
         }


         /* ゲームメッセージ表示エリアのスタイル */
         #game-message {
             font-size: large;
             font-weight: bold;
             color: #1976d2; /* デフォルトの色 - 青系 */
             margin-left: 20px; /* ボタンとの間に余白 */
         }

         /* メインコンテンツコンテナのスタイル */
         #main-content-container {
             display: flex;
             /* スマートフォン表示時にも対応するため、折り返しを許可 */
             flex-wrap: wrap;
         }

         /* ゲームフィールドコンテナのスタイル */
         #game-fields-container {
             display: flex;
             flex-direction: column;
             margin-right: 20px;
             flex-grow: 1; /* 残りのスペースを埋める */
             /* スマートフォン表示時に幅を調整 */
             width: calc(100% - 430px); /* 情報パネルの幅(410px) + 余白(20px) を引く */
             min-width: 300px; /* 最小幅を設定して極端に小さくならないように */
         }

         /* 情報・デバッグパネルコンテナのスタイル */
         #info-debug-panels {
             display: flex;
             flex-direction: column; /* パネルを縦に並べる */
             width: 410px; /* レイアウトに合わせて調整 */
             position: fixed; /* 固定位置 */
             top: 20px; /* 上からの位置 */
             right: 20px; /* 右からの位置 */
             /* スマートフォン表示時に位置を調整する場合はメディアクエリで変更 */
         }

         /* 上部右側コンテンツコンテナのスタイル (山札残り+スコア と カード情報) */
         #top-right-content {
             display: flex;
             flex-direction: row; /* 山札残り+スコアコンテナ と カード情報を横に並べる */
             align-items: flex-start; /* 上揃え */
             margin-bottom: 20px; /* デバッグパネルとの間に余白 */
             gap: 10px; /* パネル間の隙間を定義 */
         }

         /* スコア情報をまとめる新しいパネルのスタイル */
         #score-info-panel {
             width: 150px; /* 幅を調整 */
             border: 1px solid #a5d6a7; /* 薄い緑色のボーダー */
             padding: 10px;
             background-color: #e8f5e9; /* 薄い緑色の背景 */
             font-size: small;
             border-radius: 10px;
             box-shadow: 0 2px 4px rgba(0,0,0,0.1);
             color: #333;
             flex-shrink: 0; /* 縮まないように設定 */
         }

          #score-info-panel p {
              margin: 2px 0; /* 各行の上下の余白を調整 */
          }


         /* 情報パネルのスタイル */
         #card-info-panel {
             /* width: 250px; 幅を固定せず、残りのスペースを埋める */
             border: 1px solid #ccc; /* 薄いグレーのボーダー */
             padding: 10px;
             background-color: #ffffff; /* 白背景 */
             border-radius: 10px;
             color: #333; /* テキストカラー */
             box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* 控えめな影 */
             flex-grow: 1; /* 残りのスペースを埋めるように設定 */
         }

         /* デバッグパネルのスタイル */
         #debug-panel {
             width: 390px; /* 親要素の幅に合わせて調整 (410 - 10*2) */
             border: 1px solid #fbc02d; /* 黄色系のボーダー */
             padding: 10px;
             background-color: #fff9c4; /* 薄い黄色系の背景 */
             font-size: small;
             border-radius: 10px;
             box-shadow: 0 2px 4px rgba(0,0,0,0.1);
             display: none; /* デバッグパネルを非表示にする */
             color: #333; /* テキストカラー */
         }

         /* ゲーム終了時のスコア情報パネルのスタイル */
        #score-panel {
            width: 390px; /* 親要素の幅に合わせて調整 */
            border: 1px solid #64b5f6; /* 青系のボーダー */
            padding: 10px;
            margin-top: 20px; /* デバッグパネルとの間に余白 */
            background-color: #e3f2fd; /* 薄い青系の背景 */
            font-size: medium;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none; /* 初期状態では非表示 */
            color: #333; /* テキストカラー */
        }

        /* 手札枚数設定エリアのスタイル */
        #initial-hand-size-setting {
            margin-bottom: 10px; /* ボタンコンテナとの間に余白 */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: small;
        }

        #initial-hand-size-setting label {
            margin-right: 5px;
        }

        #initial-hand-size-setting input[type="number"] {
            width: 50px; /* 入力フィールドの幅を調整 */
            padding: 3px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: small;
        }


        /* スマートフォン表示用のメディアクエリ */
        @media (max-width: 768px) {
            #main-content-container {
                flex-direction: column; /* 縦並びに変更 */
            }

            #game-fields-container {
                margin-right: 0; /* 右側の余白をなくす */
                width: 100%; /* 幅を100%に */
                min-width: auto; /* 最小幅を解除 */
            }

            #info-debug-panels {
                position: static; /* 固定を解除して通常フローに */
                width: 100%; /* 幅を100%に */
                margin-top: 20px; /* ゲームフィールドとの間に余白 */
                right: auto; /* 右からの位置指定を解除 */
                left: auto; /* 左からの位置指定を解除 */
            }

            #debug-panel, #score-panel {
                 width: calc(100% - 20px); /* 親要素の幅に合わせて調整 (padding 10*2 を引く) */
            }

             #top-right-content {
                 flex-direction: column; /* 山札残り+スコア と カード情報を縦に並べる */
                 align-items: center; /* 中央揃え */
                 gap: 0; /* 縦並びの際はgapをなくす */
             }

             #score-info-panel { /* スコア情報パネル */
                 width: calc(100% - 20px); /* 親要素の幅に合わせて調整 (padding 10*2 を引く) */
                 margin-bottom: 10px; /* カード情報パネルとの間に余白 */
             }


             #card-info-panel {
                 width: calc(100% - 20px); /* 親要素の幅に合わせて調整 (padding 10*2 を引く) */
             }

              #button-container { /* 決定ボタンのコンテナ */
                  flex-direction: column; /* 縦並びに変更 */
              }

              #decision-button { /* 決定ボタン */
                  margin: 5px 0; /* ボタン間の上下余白 */
              }

              #game-message { /* ゲームメッセージ */
                  margin-left: 0; /* 左側の余白をなくす */
                  margin-top: 10px; /* ボタンとの間に余白 */
              }

               #initial-hand-size-setting { /* 手札枚数設定エリア */
                  justify-content: center; /* 中央揃え */
               }

               /* スマートフォン表示時のリスタートボタン位置調整 */
               #restart-button-container {
                   bottom: 10px; /* 下からの距離を調整 */
               }
        }

    </style>
</head>
<body>

<div id="initial-hand-size-setting">
    <label for="initial-hand-size">開始時の手札枚数:</label>
    <input type="number" id="initial-hand-size" value="4" min="1">
</div>

<div id="button-container">
    <button id="decision-button" onclick="handleDecision()">カードと移動先を選択して下さい</button>
    <div id="game-message"></div>
</div>

<div id="main-content-container">
    <div id="game-fields-container">
        <div class="field-label">手札</div>
        <div id="hand-field" style="background-color: #bbdefb; width: 100%; height: 250px; display: flex; flex-direction: row; align-items: center; padding: 10px; overflow-x: auto; margin-bottom: 20px; border-radius: 10px;">
            </div>

        <div class="field-label">場札</div>
        <div id="common-field" style="background-color: #b2dfdb; width: 100%; height: 250px; display: flex; flex-direction: row; align-items: center; padding: 10px; overflow-x: auto; margin-bottom: 20px; border-radius: 10px;">
            </div>

        <div class="field-label">捨て札</div>
        <div id="discard-field" style="background-color: #b2dfdb; width: 100%; height: 250px; display: flex; flex-direction: row; align-items: center; padding: 10px; overflow-x: auto; margin-bottom: 20px; border-radius: 10px; border: none;">
            </div>

    </div>

    <div id="info-debug-panels">
        <div id="top-right-content">
            <div id="score-info-panel">
                 <p>山札残り: <span id="deck-count"></span>枚</p>
                 <p>成功: <span id="current-successful">0</span> 回</p>
                 <p>失敗: <span id="current-failed">0</span> 回</p>
            </div>
            <div id="card-info-panel">
                <h3 style="color: black; margin-top: 0;">カード情報</h3>
                <p id="card-info-text">ここに選択したカードの情報が表示されます.</p>
            </div>
        </div>

        <div id="debug-panel">
            <h3 style="margin-top: 0;">デバッグ情報</h3>
            <p id="debug-selected-card-details">選択されたカード詳細: なし</p>
            <p id="debug-selected-front">選択された表面カード: なし</p>
            <p id="debug-selected-back">選択された裏面カード: なし</p>
            <p id="debug-back-button">裏面選択ボタン: なし</p>
            <p id="debug-result">判定結果: なし</p>
            <p id="debug-discard-info">捨て札情報: なし</p>
            <p id="debug-counts">枚数: 手札-, 場札-, 山札-, 捨て札-</p>
        </div>

        <div id="score-panel">
            <h3 style="margin-top: 0;">ゲーム結果</h3>
            <p id="final-message"></p>
            <p id="score-details"></p>
        </div>
    </div>
</div>

<div id="restart-button-container">
    <button id="restart-button" onclick="restartGame()">リスタート</button>
</div>


<script>
    // デバッグ用: JavaScriptが実行されたか確認するためのalert。問題解決後に削除してください。
    alert("Test Script");

</script>

</body>
</html>
